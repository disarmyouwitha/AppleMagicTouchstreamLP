<Window x:Class="GlassToKey.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:GlassToKey"
        Title="GlassToKey" Height="780" Width="1240" MinWidth="720" MinHeight="520"
        Background="#101214">
  <Window.Resources>
    <GroupStyle x:Key="KeymapActionGroupStyle">
      <GroupStyle.HeaderTemplate>
        <DataTemplate>
          <Border Margin="6,8,6,2" Padding="8,4" CornerRadius="6" Background="#162029" BorderBrush="#2f4251" BorderThickness="1">
            <TextBlock Text="{Binding Name}" Foreground="#8fb6cf" FontSize="11" FontWeight="SemiBold" />
          </Border>
        </DataTemplate>
      </GroupStyle.HeaderTemplate>
    </GroupStyle>
    <Style x:Key="KeymapActionComboItemStyle" TargetType="{x:Type ComboBoxItem}">
      <Setter Property="Padding" Value="8,3" />
    </Style>
  </Window.Resources>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <Border Grid.Row="0" Background="#14171a" Padding="12" BorderBrush="#2b2f33" BorderThickness="0,0,0,1">
      <DockPanel LastChildFill="True">
        <StackPanel Orientation="Vertical" DockPanel.Dock="Left">
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="GlassToKey" Foreground="#e7e9ea" FontSize="16" FontWeight="SemiBold" />
            <Button x:Name="KeymapImportButton" Content="Import Settings" Padding="10,4" Margin="12,0,0,0" />
            <Button x:Name="KeymapExportButton" Content="Export Settings" Padding="10,4" Margin="8,0,0,0" />
            <Button x:Name="ToggleControlsButton" Content="Hide Controls" Padding="10,4" Margin="6,0,0,0" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
            <Border CornerRadius="999" Background="#20252a" Padding="6,2" Margin="0,0,8,0">
              <TextBlock x:Name="LeftContactsPillText" Text="L 0" Foreground="#e7e9ea" FontSize="11" />
            </Border>
            <Border CornerRadius="999" Background="#20252a" Padding="6,2" Margin="0,0,8,0">
              <TextBlock x:Name="RightContactsPillText" Text="R 0" Foreground="#e7e9ea" FontSize="11" />
            </Border>
            <Border CornerRadius="999" Background="#20252a" Padding="6,2">
              <StackPanel Orientation="Horizontal">
                <Ellipse x:Name="IntentPillDot" Width="6" Height="6" Fill="#8b949e" Margin="0,0,4,0" VerticalAlignment="Center" />
                <TextBlock x:Name="IntentPillText" Text="idle" Foreground="#e7e9ea" FontSize="11" />
              </StackPanel>
            </Border>
            <Border CornerRadius="999" Background="#20252a" Padding="6,2" Margin="8,0,0,0">
              <StackPanel Orientation="Horizontal">
                <Ellipse x:Name="ModePillDot" Width="6" Height="6" Fill="#6b7279" Margin="0,0,4,0" VerticalAlignment="Center" />
                <TextBlock x:Name="ModePillText" Text="n/a" Foreground="#e7e9ea" FontSize="11" />
              </StackPanel>
            </Border>
            <TextBlock x:Name="StatusText" Text="State: n/a" Foreground="#b8c1c7" FontSize="14" VerticalAlignment="Center" Visibility="Collapsed" />
          </StackPanel>
        </StackPanel>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center" Margin="0,0,8,0">
          <StackPanel x:Name="ReplayPanel" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,12,0" Visibility="Collapsed">
            <Button x:Name="ReplayToggleButton" Content="Play" Padding="10,4" />
            <Button x:Name="ReplayStepBackButton" Content="&#x25C0;" Width="28" Height="26" Margin="8,0,0,0" />
            <Button x:Name="ReplayStepForwardButton" Content="&#x25B6;" Width="28" Height="26" Margin="4,0,0,0" />
            <CheckBox x:Name="ReplayLoopCheckBox" Content="Loop" Foreground="#8b949e" VerticalAlignment="Center" Margin="8,0,0,0" />
            <TextBlock Text="Speed" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" Margin="10,0,6,0" />
            <ComboBox x:Name="ReplaySpeedCombo" Width="90" Height="26" />
            <Slider x:Name="ReplayTimelineSlider" Width="220" Height="22" Minimum="0" Maximum="1000" Margin="10,0,0,0" />
            <TextBlock x:Name="ReplayTimeText" Text="0.00s" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0" />
          </StackPanel>
        </StackPanel>
      </DockPanel>
    </Border>

    <Border Grid.Row="1" Background="#0f1215" Padding="12" BorderBrush="#2b2f33" BorderThickness="0,0,0,1">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <StackPanel Grid.Column="0" Orientation="Vertical" Margin="0,0,12,0">
          <TextBlock Text="Left Trackpad" Foreground="#8b949e" FontSize="12" />
          <ComboBox x:Name="LeftDeviceCombo" Height="28" />
          <TextBlock Text="Decoder" Foreground="#8b949e" FontSize="12" Margin="0,6,0,0" />
          <ComboBox x:Name="LeftDecoderProfileCombo" Height="26" />
        </StackPanel>
        <StackPanel Grid.Column="1" Orientation="Vertical" Margin="0,0,12,0">
          <TextBlock Text="Right Trackpad" Foreground="#8b949e" FontSize="12" />
          <ComboBox x:Name="RightDeviceCombo" Height="28" />
          <TextBlock Text="Decoder" Foreground="#8b949e" FontSize="12" Margin="0,6,0,0" />
          <ComboBox x:Name="RightDecoderProfileCombo" Height="26" />
        </StackPanel>
        <StackPanel Grid.Column="2" Orientation="Vertical">
          <TextBlock Text="Devices" Foreground="#8b949e" FontSize="12" />
          <Button x:Name="RefreshButton" Content="Refresh" Padding="10,4" Height="28" />
        </StackPanel>
      </Grid>
    </Border>

    <Grid Grid.Row="2" Margin="16">
      <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>

      <Border Grid.Row="0" Grid.Column="0" Margin="0,0,12,0" Background="#0c0f12" BorderBrush="#2b2f33" BorderThickness="1" CornerRadius="12">
        <local:TouchView x:Name="LeftSurface" />
      </Border>

      <Border Grid.Row="0" Grid.Column="1" Margin="0,0,12,0" Background="#0c0f12" BorderBrush="#2b2f33" BorderThickness="1" CornerRadius="12">
        <local:TouchView x:Name="RightSurface" />
      </Border>

      <Border x:Name="ControlsPaneBorder" Grid.Row="0" Grid.RowSpan="2" Grid.Column="2" Width="360" Background="#0c0f12" BorderBrush="#2b2f33" BorderThickness="1" CornerRadius="12">
        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="12">
          <StackPanel Orientation="Vertical">
            <TextBlock Text="Controls" Foreground="#e7e9ea" FontSize="14" FontWeight="SemiBold" />

            <TextBlock Text="Layout" Foreground="#8b949e" FontSize="12" Margin="0,10,0,2" />
            <ComboBox x:Name="LayoutPresetCombo" Height="26" />
            <Expander IsExpanded="False" Margin="0,8,0,0">
              <Expander.Header>
                <TextBlock Text="Column Settings" Foreground="#8b949e" FontSize="12" />
              </Expander.Header>
              <StackPanel Margin="0,6,0,0">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Edit Column" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <ComboBox x:Name="ColumnLayoutColumnCombo" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Column Scale (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="ColumnScaleBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Column Spacing (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="KeyPaddingBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Column X (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="ColumnOffsetXBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Column Y (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="ColumnOffsetYBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Button x:Name="ColumnAutoSplayButton"
                        Content="Auto Splay (4+ Fingers)"
                        Height="26"
                        Margin="0,8,0,0" />
                <Button x:Name="ColumnEvenSpaceButton"
                        Content="e v e n s p a c e"
                        Height="26"
                        Margin="0,6,0,0" />
              </StackPanel>
            </Expander>

            <Expander x:Name="KeymapEditorExpander" IsExpanded="False" Margin="0,12,0,0">
              <Expander.Header>
                <TextBlock Text="Keymap Editor" Foreground="#8b949e" FontSize="12" />
              </Expander.Header>
              <StackPanel Margin="0,6,0,0">
                <ComboBox x:Name="LayerCombo" Height="26" />
                <TextBlock Text="Primary Action" Foreground="#8b949e" FontSize="12" Margin="0,8,0,2" />
                <ComboBox x:Name="KeymapPrimaryCombo" Height="26" DisplayMemberPath="Display" SelectedValuePath="Value" MaxDropDownHeight="420" ItemContainerStyle="{StaticResource KeymapActionComboItemStyle}">
                  <ComboBox.GroupStyle>
                    <StaticResource ResourceKey="KeymapActionGroupStyle" />
                  </ComboBox.GroupStyle>
                </ComboBox>
                <TextBlock Text="Hold Action (optional)" Foreground="#8b949e" FontSize="12" Margin="0,8,0,2" />
                <ComboBox x:Name="KeymapHoldCombo" Height="26" DisplayMemberPath="Display" SelectedValuePath="Value" MaxDropDownHeight="420" ItemContainerStyle="{StaticResource KeymapActionComboItemStyle}">
                  <ComboBox.GroupStyle>
                    <StaticResource ResourceKey="KeymapActionGroupStyle" />
                  </ComboBox.GroupStyle>
                </ComboBox>
                <TextBlock Text="Custom Buttons" Foreground="#8b949e" FontSize="12" Margin="0,12,0,2" />
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <Button x:Name="CustomButtonAddLeftButton" Content="Add Left" Height="28" Margin="0,0,6,0" />
                  <Button x:Name="CustomButtonAddRightButton" Grid.Column="1" Content="Add Right" Height="28" />
                </Grid>

                <Grid Margin="0,10,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="X (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="CustomButtonXBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Y (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="CustomButtonYBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Width (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="CustomButtonWidthBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Height (%)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="CustomButtonHeightBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Button x:Name="CustomButtonDeleteButton" Content="Delete Selected Button" Height="28" Margin="0,8,0,0" />
              </StackPanel>
            </Expander>

            <Expander IsExpanded="False" Margin="0,12,0,0">
              <Expander.Header>
                <TextBlock Text="Typing Tuning" Foreground="#8b949e" FontSize="12" />
              </Expander.Header>
              <StackPanel Margin="0,6,0,0">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Hold Duration (ms)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="HoldDurationBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Typing Grace (ms)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="TypingGraceBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Drag Cancel (mm)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="DragCancelBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Intent Move (mm)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="IntentMoveBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Intent Velocity (mm/s)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="IntentVelocityBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Tap Stagger (ms)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="TapStaggerBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Tap Cadence (ms)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="TapCadenceBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,6,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="90" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Tap Move Threshold (mm)" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <TextBox x:Name="TapMoveBox" Grid.Column="1" Height="24" Margin="8,0,0,0" />
                </Grid>
                <Grid Margin="0,12,0,0">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="140" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Text="Haptic Strength" Foreground="#8b949e" FontSize="12" VerticalAlignment="Center" />
                  <StackPanel Grid.Column="1" Margin="8,0,0,0">
                    <Slider x:Name="HapticsStrengthSlider" Minimum="0" Maximum="70" TickFrequency="1" IsSnapToTickEnabled="True" Height="22" />
                    <Grid Margin="0,2,0,0">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                      </Grid.ColumnDefinitions>
                    <TextBlock Text="0" Foreground="#6b7279" FontSize="10" HorizontalAlignment="Left" />
                    <TextBlock Grid.Column="1" Text="70" Foreground="#6b7279" FontSize="10" HorizontalAlignment="Right" />
                    </Grid>
                  </StackPanel>
                </Grid>
              </StackPanel>
            </Expander>

            <Expander IsExpanded="True" Margin="0,12,0,0">
              <Expander.Header>
                <TextBlock Text="Mode Toggles" Foreground="#8b949e" FontSize="12" />
              </Expander.Header>
              <StackPanel Margin="0,6,0,0">
                <CheckBox x:Name="TapClickEnabledCheck" Content="Tap Click" Foreground="#8b949e" Margin="0,4,0,0" />
                <CheckBox x:Name="ChordShiftCheck" Content="Chordal Shift" Foreground="#8b949e" Margin="0,4,0,0" />
                <CheckBox x:Name="SnapRadiusModeCheck" Content="Snap Radius" Foreground="#8b949e" Margin="0,4,0,0" />
                <CheckBox x:Name="RunAtStartupCheck" Content="Run at Windows startup" Foreground="#8b949e" Margin="0,4,0,0" />
                <CheckBox x:Name="KeyboardModeCheck" Content="Keyboard-only" Foreground="#8b949e" Margin="0,4,0,0" />
              </StackPanel>
            </Expander>

          </StackPanel>
        </ScrollViewer>
      </Border>

      <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,10,12,0" Background="#0c0f12" BorderBrush="#2b2f33" BorderThickness="1" CornerRadius="12" Padding="12,10">
        <StackPanel Orientation="Vertical">
          <TextBlock Text="Typing Test" Foreground="#8b949e" FontSize="12" Margin="0,0,0,4" />
          <TextBox x:Name="TypingTestBox"
                   Height="48"
                   AcceptsReturn="True"
                   TextWrapping="Wrap"
                   VerticalScrollBarVisibility="Auto" />
        </StackPanel>
      </Border>
    </Grid>
  </Grid>
</Window>
